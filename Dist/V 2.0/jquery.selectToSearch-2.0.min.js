!function(e){function t(){r.val(f[u].Value),i()}function i(t){null!=r&&(r.show(),h=null,u=-1,f=[],d=[],v=!1,r=null,e(".selectToSearch_container").remove())}function l(e){var i=e.keyCode;if(40==i||38==i){e.preventDefault();var l;h.filter(".activeList-SelectToSearch").removeClass("activeList-SelectToSearch"),40==i?u=++u==h.length?0:u:38==i&&(u=--u<0?h.length-1:u),(l=h.eq(u)).closest("ul").scrollTop(u*l.outerHeight()),l.addClass("activeList-SelectToSearch")}else 13==i&&t()}function n(t){var i=t.keyCode;if(40!=i&&38!=i&&13!=i){var l=e(this).val().toLowerCase(),n=e("#selectToSearch_list");ListInnerHtml="",f=[],d.forEach(function(e){e.CmpText.indexOf(l)>=0&&(f.push({Value:e.Value}),ListInnerHtml+="<li>"+e.Text+"</li>")}),n.html("").html(ListInnerHtml),h=n.find("li"),u=-1}}function s(e){return String(e).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function a(c){if(null==h){r=e(c),u=r.find(":selected").index();var o=document.createElement("input"),T="",m=r.width(),S=document.createElement("ul"),p=document.createElement("div");p.className="selectToSearch_container",p.style.width=m+"px",S.onmouseenter=function(){v=!0},S.onmouseleave=function(){v=!1},o.type="text",o.value=r.find(":selected").text(),o.id="txtSelectToSearch",o.onkeyup=n,o.onkeydown=l,o.onblur=function(e){v||i()},o.style.cssText=r.attr("style"),o.style.height=r.height();var x=r.attr("class");x.length>0&&(o.className=x),S.style.cssText="height:0px;border:"+r.css("border")+";",S.id="selectToSearch_list",f=[];var g,y,L,C;r.find("option").each(function(){g=e(this),L=g.text(),y=g.val(),C=s(L),d.push({Text:C,Value:y,CmpText:L.toLowerCase()}),f.push({Value:y}),T+="<li>"+C+"</li>"}),S.innerHTML=T,p.appendChild(o),p.appendChild(S),r.after(p),h=e(S).find("li");var w=e("#selectToSearch_list li").eq(u);w.closest("ul").scrollTop(u*w.outerHeight()),w.addClass("activeList-SelectToSearch"),r.hide(),o.focus(),e(S).on("mousedown","li",function(i){u=e(this).index(),t(),i.preventDefault()}).on("mouseover","li",function(){u=e(this).index(),h.filter(".activeList-SelectToSearch").removeClass("activeList-SelectToSearch"),e(this).addClass("activeList-SelectToSearch")}).height("auto")}else setTimeout(function(){a(c)},100)}function c(){var t=document.createElement("input"),i="",l=document.createElement("datalist");r=e(this),t.id="selectToSearch",t.setAttribute("list","selectToSearch_datalist"),t.onblur=o,t.style.cssText=r.attr("style"),t.style.width=r.width(),t.style.height=r.height();var n=r.attr("class");n.length>0&&(t.className=n),l.id="selectToSearch_datalist",r.find("option").each(function(){i+='<option data-value="'+e(this).val()+'"value="'+e(this).text()+'"/>'}),l.innerHTML=i,t.value=r.find(":selected").text(),r.after(t).after(l),r.hide(),t.focus()}function o(){var t=e(this).val();e("#selectToSearch").remove(),e("#selectToSearch_datalist").remove(),r.find("option").each(function(){if(t==e(this).text())return r.val(e(this).val()),!1}),r.show()}var r,h,u=-1,d=[],f=[],v=!1;e.fn.selectToSearch=function(t){return t?e(this).focusin(function(){a(this)}):e(this).focusin(c),this}}(jQuery);